<?php

namespace app\api\controller;

use Firebase\JWT\JWT;
use Firebase\JWT\Key;
use think\facade\Env;

class Base extends Cross
{
    protected function initialize()
    {
        parent::initialize(); // TODO: Change the autogenerated stub

        //鉴权
        //获取Token，判断Token
        $header = request()->header();
        if(!isset($header['token']) || empty($header['token'])){
           return error('token不存在',1);
        }
        $jwt = new JWT();
        $info = $jwt::decode($header['token'], new Key(Env::get('token_key'),'HS256'));
        $this->aid = $info->aid;
    }
}
